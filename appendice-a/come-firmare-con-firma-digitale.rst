5.2 Come firmare con firma digitale
===================================

Alcuni moduli o allegati dovranno essere firmati con firma digitale dai
diversi soggetti a cui sono intestati. Il sistema indica il codice
fiscale del soggetto che dovrà apporre la firma. Fa eccezione la delega,
che non richiede alcuna firma digitale, ma solo quella autografa di
delegante e delegato.

Ecco i passi da seguire per firmare tutti i file correttamente.

1. Il file deve innanzitutto essere scaricato utilizzando il pulsante
   |image0|

|image1|

**ATTENZIONE!**

Il file viene generalmente **salvato in automatico nella cartella di
download** impostata nel browser, da cui può essere copiato in un’altra
cartella e, se utile, rinominato. È possibile accedere alla posizione
del file scaricato cliccando sulla freccia come indicato in figura, poi
su “Mostra nella cartella”:

|image2|

Altre volte invece il file viene **aperto di default con Adobe Reader**
(o altro programma di visualizzazione di PDF). In questo caso, per
evitare di cambiare l’impronta (HASH) del file scaricato, è necessario
chiudere il programma **senza fare “salva con nome”**.

Se si vuole risalire alla posizione del file una volta aperto con Adobe,
basta cliccare su **File → Proprietà → Descrizione → Posizione**, come
mostrato nell’immagine.

|image3|

2. Il file scaricato deve quindi essere firmato, o fatto firmare,
   digitalmente in **modalità CADES (cioè come pdf.p7m)** dal soggetto
   indicato dal sistema. Per fare questo si potrà utilizzare il software
   di firma più consono in base al dispositivo posseduto (ad es. Dike,
   Fileprotector, …)

3. Il file firmato va infine caricato sullo Sportello utilizzando il
   pulsante |image4|

|image5|

Compare quindi il box per caricare il file dove è possibile scegliere un
file sfogliando tra le proprie cartelle oppure trascinarlo all’interno
del box.

|image6|

Una volta caricato il file il sistema ne verifica la correttezza:

**1. Verifica del firmatario:** Viene verificato che il firmatario del
file caricato sia proprio il soggetto che era tenuto alla firma (cioè
quello avente il codice fiscale indicato dal sistema). Se il firmatario
risulta essere un altro viene mostrato il seguente messaggio di errore:

|image7|

**2. Verifica del contenuto del file firmato:** Viene quindi verificato
che il contenuto del file caricato
(*pdf-statico-elemento-firmato.pdf.p7m*) sia esattamente quello del file
precedentemente generato dal sistema (*pdf-statico-elemento.pdf*). Se il
contenuto dovesse essere diverso (vengono verificate le impronte, HASH,
dei due file) viene mostrato il seguente messaggio di errore:

|image8|

Al contrario, se il file caricato è corretto il sistema lo identifica
come **“Firmato con successo”**

|image9|

.. |image0| image:: ./media/image71.png
   :width: 0.25in
   :height: 0.23704in
.. |image1| image:: ./media/image161.png
   :width: 5.32813in
   :height: 1.30286in
.. |image2| image:: ./media/image163.png
   :width: 6.91292in
   :height: 1.35417in
.. |image3| image:: ./media/image150.png
   :width: 6.91868in
   :height: 3.67033in
.. |image4| image:: ./media/image71.png
   :width: 0.25296in
   :height: 0.25in
.. |image5| image:: ./media/image93.png
   :width: 6.63021in
   :height: 1.63266in
.. |image6| image:: ./media/image81.png
   :width: 4.02079in
   :height: 1.15281in
.. |image7| image:: ./media/image38.png
   :width: 4.625in
   :height: 1.84421in
.. |image8| image:: ./media/image60.png
   :width: 5.39583in
   :height: 1.84775in
.. |image9| image:: ./media/image16.png
   :width: 7.08973in
   :height: 0.56944in
